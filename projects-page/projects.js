const projects2023 = [
    {
        title: 'Greater Washington County Food Bank',
        description: "The Greater Washington County Food Bank's mission is to help those who are fighting against hunger. The CMU IS students' role is to help standardize the onboarding process for volunteers and incoming staff. The result was an improved understanding of the food bank's CRM for both staff and volunteers.",
        logo: '../assets/SP23-Logos/GWCFB.png',
        communityPartners: ['Cherise Sandrock'],
        studentConsultingTeam: ['Emma Kwan', 'Meghana Tera', 'Ricky Lee', 'Yize Shen'],
        execSummary: './exec-summaries/s23/GWCFB.pdf',
        tags: 'zerohunger userexperience'
    },
    {
        title: 'Filipino-American Association of Pittsburgh',
        description: "The Filipino-American Association of Pittsburgh's mission is to preserve, promote, and perpetuate the Filipino heritage among its members and the general public through cultural, charitable, and educational activities. The CMU IS students improved their data management due to their lack of centralization and automation. The result was an improved website with automated data collection and transfer of legacy data into their new system.",
        logo: '../assets/SP23-Logos/FAAP.jpg',
        communityPartners: ['Leilani Mears'],
        studentConsultingTeam: ['Lea De Vylder', 'Michelle Liu', 'Alex Barrios'],
        execSummary: './exec-summaries/s23/FAAP.pdf',
        tags: 'equality peaceandinclusion databasesolution webapp'
    },
    {
        title: 'The Italian Garden Project',
        description: 'The mission of The Italian Garden Project is to celebrate the joy and wisdom inherent in the traditional Italian American vegetable garden, preserving this heritage and demonstrating its relevance for reconnecting to our food, our families and the earth. The CMU IS students created The Legacy Fig Tree Archive website that allows individuals to enter their fig tree into the archive and search the database for the fig trees. The archive demonstrates the prevalence of the fig growing tradition throughout the US and creates a sense of community for fig tree owners.',
        logo: '../assets/SP23-Logos/IGP.png',
        communityPartners: ['Mary Menniti'],
        studentConsultingTeam: ['Anna Rippert', 'Cami Wu', 'Daniel Arriola'],
        execSummary: './exec-summaries/s23/IGP.pdf',
        tags: 'lifeonland goodhealthandwellbeing qualityeducation responsibleconsumption zerohunger webapp userexperience databasesolution'
    },
    {
        title: 'New Sun Rising',
        description: 'New Sun Rising (NSR) is a nonprofit organization that organizes and supports community development initiatives within Pittsburgh, with the mission "Build vibrant communities through culture, sustainability, and opportunity". The CMU IS students worked with New Sun Rising to create a digital form to collect contextual data (opinions/fears/hopes) of members of a community and store it within their database. This will add value by giving additional information to properly understand problems local Pittsburgh communities are facing.',
        logo: '../assets/SP23-Logos/NewSunRising.png',
        communityPartners: ['Scott Wolovich'],
        studentConsultingTeam: ['Mahith Edula', 'Neel Mandapati', 'Zexuan Li', 'Ziyan Wang'],
        execSummary: './exec-summaries/s23/NewSunRising.pdf',
        tags: 'partnershipsforgoals peaceandinclusion api databasesolution technologystrategy userexperience'
    },
    {
        title: 'Project Theia',
        description: "Project Theia's mission is to provide oculoplastic medical and surgical care to the underserved global community. The CMU IS students furthered this mission by enhancing remote communication with all of their Global Providers, preparing Project Theia to scale. The team utilized Slack to centralize communication, organize educational resources, and support effective remote communication.",
        logo: '../assets/SP23-Logos/ProjectTheia.jpg',
        communityPartners: ['Jenny Yu'],
        studentConsultingTeam: ['Brianna Wang', 'Erica Fu', 'Victoria Zhang'],
        execSummary: './exec-summaries/s23/ProjectTheia.pdf',
        tags: 'goodhealthandwellbeing applicationintegration'
    },
    {
        title: 'Women Against Abusive Relationships',
        description: "Women Against Abusive Relationships (WAAR) is a Pittsburgh-based volunteer organization that aims to break the cycle of domestic violence by providing education, awareness, and prevention programs, directed by Roxanne Epperson. The CMU IS student team revamped the website to meet ADA compliance, and restructured the information architecture to optimize usability, to help users find the resources they need quickly and efficiently.",
        logo: '../assets/SP23-Logos/WAAR.png',
        communityPartners: ['Roxanne Epperson'],
        studentConsultingTeam: ['Amy Deng', 'Cathryn Lin', 'Lucy Li'],
        execSummary: './exec-summaries/s23/WAAR.pdf',
        tags: 'genderequality goodhealthandwellbeing peaceandinclusion softwareintegration technologystrategy userexperience'
    },
    {
        title: 'Queens Gambit Chess Institute',
        description: "Queens Gambit is an organization that aims to empower youth through chess, especially those who are underrepresented in the chess community. The team implemented two solutions for Queens Gambit: a new online tournament pairing system and updating their community partner relationship management system. As a result, Queens Gambit is able to run their classes and tournaments more effectively and manage their partner data in a more organized manner.",
        logo: '../assets/SP23-Logos/QueensGambit.jpeg',
        communityPartners: ['Ashley Lynn Priore'],
        studentConsultingTeam: ["Angela Chen", 'Saaatvik Korisepati', 'Lisa Leung', 'Emmeline Wetzel'],
        execSummary: './exec-summaries/s23/QueensGambit.pdf',
        tags: 'equality genderequality webapp userexperience softwareintegration'
    },
    {
        title: 'Computer Reach',
        description: "Computer Reach's mission is to make technology available to people most in need through refurbished equipment, computer literacy, training, and support. The CMU IS student team developed a Python script to automate the device data collection and upload process of incoming machines donated to the organization. With this script, Computer Reach is able to improve productivity, save time and effort. as well as minimize errors from manual data entry.",
        logo: '../assets/SP23-Logos/ComputerReach.jpg',
        communityPartners: ['Kyle Spangler'],
        studentConsultingTeam: ['Brandan Chen', 'Elyse Im', 'Joanna Yao'],
        execSummary: './exec-summaries/s23/ComputerReach.pdf',
        tags: 'equality partnershipsforgoals qualityeducation industryinnovationinfrastructure api softwareintegration technologystrategy'
    },
    {
        title: 'Protect Penn-Trafford',
        description: "Protect Penn-Trafford (Protect PT) is committed to protecting Penn-Trafford and surrounding communities from the harmful environmental effects of energy projects through education and legal advocacy. The CMU IS students developed a web application with functionality to allow data entry and retrieval of information related to energy projects. The web application was used as a working prototype to demonstrate to potential funders the potential of this system.",
        logo: '../assets/SP23-Logos/ProtectPT.jpg',
        communityPartners: ['Chelsea Buell', 'Jim Cirilano', 'Gillian Graber'],
        studentConsultingTeam: ['Clara Lam', 'Jason Perez', 'Michael Song'],
        execSummary: './exec-summaries/s23/ProtectPT.pdf',
        tags: 'cleanenergy cleanwater climateaction lifeonland peaceandinclusion goodhealthandwellbeing responsibleconsumption sustainablecities databasesolution webapp'
    },
    {
        title: 'JADA House International',
        description: "JADA House International uplifts the Hazelwood and Greater Pittsburgh community by providing an inclusive physical space where teens, senior citizens, and families can build positive relationships within their community and strengthen their social, emotional, and spiritual lives. The CMU IS students developed and redesigned the organizations' current website to enhance community engagement, increase communication, and attract more donors while taking advantage of website analytics to better serve their community. The impact of our project is expected to attract new members and donors while effectively advertising programs and services to serve more individuals in need.",
        logo: '../assets/SP23-Logos/JADA_House.png',
        communityPartners: ['Terri Shields'],
        studentConsultingTeam: ['Anesha Santhanam', 'Emily Ngo', 'Fernanda Molina', 'Valeria Cordova'],
        execSummary: './exec-summaries/s23/JADA_House.pdf',
        tags: 'peaceandinclusion dataanalytics userexperience webapp'
    },
    {
        title: 'Amachi Pittsburgh',
        description: "Amachi Pittsburgh is a non-profit organization dedicated to empowering, nurturing, and protecting youth affected by incarceration in the Greater Pittsburgh area through mentoring programs. The CMU IS students developed a communication platform on Geneva to build a community for Amachi's mentors, providing a range of support resources. This initiative fosters a sense of community among mentors and streamlines communication between staff and mentors, ultimately contributing to more effective mentorship and improved outcomes for the youth involved.",
        logo: '../assets/SP23-Logos/Amachi.png',
        communityPartners: ['Caily Grube'],
        studentConsultingTeam: ['Saloni Gandhi', 'Kimberly Gao', 'Zhuowen (Helen) Huang', 'Zahir Saiyed'],
        execSummary: './exec-summaries/s23/Amachi.pdf',
        tags: 'equality qualityeducation api technologystrategy userexperience webapp'
    },
    {
        title: 'Youth Enrichment Services',
        description: 'Youth Enrichment Services (YES) aims to empower socially and economically at-risk youth to achieve success through academic preparation, career exploration, and cultural and social leadership development. The CMU IS student team developed a mobile and web application to streamline the arduous SMS communication process with YES students, which was previously time-intensive and constrained staff capacity. With this automated communication system, all YES students can get notified about events in a timely manner while improving YES’ capacity for student enrichment.',
        logo: '../assets/SP23-Logos/YES.png',
        communityPartners: ['Deanna Sinex'],
        studentConsultingTeam: ['Colin May', 'Nathan Wai', 'Daniel Gunawan'],
        execSummary: './exec-summaries/s23/YES.pdf',
        tags: 'peaceandinclusion goodhealthandwellbeing qualityeducation workandeconomicgrowth webapp api softwareintegration mobileapp'
    }
]

const projects2022 = [
    {
        title: 'KidsVoice',
        description: "KidsVoice is a nonprofit legal agency that represents abused, neglected, and at-risk children, up to the age of 24. The CMU IS team created a database and data migration solution that is able automate the process of tracking clients and their relevant cases. This project helps save KidsVoice 5-7 hours per week.",
        logo: '../assets/SP22-Logos/kidsvoice.png',
        communityPartners: ['Tom Welschonce', 'Tara Gainfort'],
        studentConsultingTeam: ['Thomas Choi', 'Roshan Ram', 'Brian Chou'],
        execSummary: './exec-summaries/s22/kidsvoice.pdf',
        tags: 'equality genderequality peaceandinclusion goodhealthandwellbeing qualityeducation workeconomicgrowth zerohunger databasesolution'
    },
    {
        title: "The Children's Home",
        description: "The Children's Home of Pittsburgh is an independent, non-profit, licensed organization whose mission is to promote the health and wellbeing of infants and children through services that establish and strengthen the family. The CMU IS student team digitized the breast-milk verification and inventory tracking system. This system helps streamline the bottle check in and checkout processes, saves paperwork from the old manual process, and reduces human error by delegating calculations to the technology.",
        logo: '../assets/SP22-Logos/childrenshome.jpg',
        communityPartners: ['Lisa Houlihan', 'Kimberly Hennigan'],
        studentConsultingTeam: ['Anagha Srikumar', 'Tim Wang', 'Varshaa SJ'],
        execSummary: './exec-summaries/s22/childrenshome.pdf',
        tags: 'goodhealthandwellbeing webapp'
    },
    {
        title: "Red Cloud Indian School",
        description: "Our vision for this engagement was to modernize Lakota by increasing its representation in technology. In order to do this, we explored many different avenues from open-source educational games, interactive storytelling platforms, and through Minecraft.",
        logo: '../assets/SP22-Logos/RCIS.jpeg',
        communityPartners: ['Matthew Rama'],
        studentConsultingTeam: ['Mikail Cheema', 'Vishesh Pagarani', 'Neha Joshi'],
        execSummary: './exec-summaries/s22/RCIS.pdf',
        tags: 'qualityeducation softwareintegration'
    },
    {
        title: "Patchy Fog",
        description: "Patchy Fog spreads outdoor, self guided education to get those who may normally be glued to their computers, out of the house. The CMU IS team is helping to spread the project further from the initial school district where it was implemented by building a virtual community for social interaction and collaboration, as well as a webapp to submit and view the products of community members.",
        logo: '../assets/SP22-Logos/patchyfog.jpg',
        communityPartners: ['Damon Hargraves'],
        studentConsultingTeam: ['Kalen Gressler', 'Siddharth Paratkar', 'Max Sobkov'],
        execSummary: './exec-summaries/s22/patchyfog.pdf',
        tags: 'industryinnovationinfrastructure qualityeducation webapp geographicinformationsystems socialmedia'
    },
    {
        title: "Queens Gambit",
        description: "The Queens Gamit Chess Institute's mission is to provide enrichment chess classes to under served communities in the greater Pittsburgh area. The CMU IS developed a CRM wesbite using Ruby on Rails for TQGCI to better manage community partnerships and programs.",
        logo: '../assets/SP22-Logos/TQGCI.png',
        communityPartners: ['Ashley Priore'],
        studentConsultingTeam: ['Allison Cao', 'Waverly Chin', 'Sara Song'],
        execSummary: './exec-summaries/s22/patchyfog.pdf',
        tags: 'qualityeducation genderequality webapp'
    },
    {
        title: "Primate Portal",
        description: "The Queens Gamit Chess Institute's mission is to provide enrichment chess classes to under served communities in the greater Pittsburgh area. The CMU IS developed a CRM wesbite using Ruby on Rails for TQGCI to better manage community partnerships and programs.",
        logo: '../assets/SP22-Logos/primateportal.jpg',
        communityPartners: ['Ashley Priore'],
        studentConsultingTeam: ['Allison Cao', 'Waverly Chin', 'Sara Song'],
        execSummary: './exec-summaries/s22/primateportal.pdf',
        tags: 'qualityeducation genderequality webapp'
    }
]

allProjects = [projects2023, projects2022];
mostRecentProjectYear = 2023;

function createProject(data) {
    const projectContainer = document.createElement('div');
    projectContainer.className = 'col-lg-2 col-md-4 col-sm-6 my-2';
    const project = document.createElement('div');
    project.className = 'text-center bg-light border p-2 position-relative project';

    const projectLogo = document.createElement('img');
    projectLogo.src = data.logo;
    projectLogo.alt = `${data.title}'s logo`;
    projectLogo.className = 'img-fluid';

    const learnMore = document.createElement('button');
    learnMore.className = 'btn d-none learn-more text-white';
    learnMore.style.backgroundColor = '#008F91';
    learnMore.textContent = 'View Project';

    project.style.transition = 'transform 0.5s ease';
    project.addEventListener('mouseenter', () => {
        learnMore.classList.remove('d-none');
        project.style.transform = 'translateY(-7px)';
        projectLogo.style.opacity = '0.3';
    });

    project.addEventListener('mouseleave', () => {
        learnMore.classList.add('d-none');
        project.style.transform = '';
        projectLogo.style.opacity = '1';

    });

    learnMore.addEventListener('click', () => {
        const communityPartnersContainer = document.getElementById('communityPartners');
        communityPartnersContainer.innerHTML = `<span class="modal-heading">${data.communityPartners.length > 1 ? 'Community Partners' : 'Community Partner'}</span>: ${data.communityPartners.join(', ')}`;

        const studentConsultingTeamContainer = document.getElementById('studentConsultingTeam');
        studentConsultingTeamContainer.innerHTML = `<span class="modal-heading">Student Consulting Team</span>: ${data.studentConsultingTeam.join(', ')}`;
        studentConsultingTeamContainer.classList.add('font-weight-normal');

        const projectDescription = document.getElementById('projectDescription');
        projectDescription.innerHTML = `<span class="modal-heading">Description</span>: ${data.description}`;

        const modalLogo = document.getElementById('modalLogo');
        modalLogo.src = data.logo;
        modalLogo.alt = `Logo for ${data.title}`;

        const projectModalLabel = document.getElementById('projectModalLabel');
        projectModalLabel.innerHTML = data.title;

        const execSummaryButton = document.getElementById('execSummaryButton');
        execSummaryButton.onclick = function () {
            window.open(data.execSummary, '_blank');
        };

        const projectTags = document.getElementById('projectTags');
        projectTags.innerHTML = '';

        const badgeContainer = document.createElement('div');
        badgeContainer.className = 'd-flex flex-wrap';

        data.tags.split(' ').forEach(tag => {
            const badge = document.createElement('span');
            badge.className = 'badge badge-secondary p-2 m-1 carnegie-red font-weight-normal';
            badge.textContent = tag;
            badgeContainer.appendChild(badge);
        });

        projectTags.appendChild(badgeContainer);

        $('#projectModal').modal('show');
    });

    project.appendChild(projectLogo);
    project.appendChild(learnMore);

    projectContainer.appendChild(project);
    return projectContainer;
}

function displayProjects(projectsArray) {
    const allProjectsContainer = document.getElementById('all-projects');
    allProjectsContainer.innerHTML = '';
    projectsArray.forEach((projectsData, index) => {
        const yearHeading = document.createElement('h2');
        yearHeading.textContent = `Spring ${mostRecentProjectYear - index}`;
        yearHeading.className = 'text-center';

        allProjectsContainer.appendChild(yearHeading);

        const projectsContainer = document.createElement('div');
        projectsContainer.id = `projects${mostRecentProjectYear - index}`;
        projectsContainer.className = 'row mx-auto';

        projectsData.forEach(project => {
            projectsContainer.appendChild(createProject(project));
        });

        allProjectsContainer.appendChild(projectsContainer);
    });
}

function getSelectedCheckboxes(filterId) {
    const checkboxes = document.querySelectorAll(`#${filterId} input[type="checkbox"]:checked`);
    return Array.from(checkboxes).map(checkbox => checkbox.value);
}

function createFilterBadge(tag, filterId) {
    const badge = document.createElement('span');
    badge.className = 'badge p-2 m-1 font-weight-normal filterBadge';

    const badgeText = document.createElement('span');
    badgeText.textContent = tag;

    const removeButton = document.createElement('button');
    removeButton.className = 'btn btn-sm text-light p-0 m-0 ml-1';
    removeButton.innerHTML = '&times;';

    removeButton.addEventListener('click', function () {
        const checkbox = document.querySelector(`#${filterId} input[value="${tag}"]`);
        if (checkbox) {
            checkbox.checked = false;
            filterProjects();
        }
    });

    badge.appendChild(badgeText);
    badge.appendChild(removeButton);

    return badge;
}

function displaySelectedSDGTags(selectedSDGs) {
    const selectedTagsContainer = document.getElementById('selectedSDGTags');
    selectedTagsContainer.innerHTML = '';

    if (selectedSDGs.length > 0) {
        selectedSDGs.forEach(tag => {
            const badge = createFilterBadge(tag, 'sdg-filter');
            selectedTagsContainer.appendChild(badge);
        });
    }
}

function displaySelectedTechTags(selectedTech) {
    const selectedTagsContainer = document.getElementById('selectedTechTags');
    selectedTagsContainer.innerHTML = '';

    if (selectedTech.length > 0) {
        selectedTech.forEach(tag => {
            const badge = createFilterBadge(tag, 'tech-filter');
            selectedTagsContainer.appendChild(badge);
        });
    }
}

function getMatchingProjects(projects, selectedSDGs, selectedTech, searchTerm) {
    return projects.filter(project => {
        const hasMatchingSDGTags = selectedSDGs.every(tag => project.tags.includes(tag));
        const hasMatchingTechTags = selectedTech.every(tag => project.tags.includes(tag));
        const hasMatchingSearch = project.title.toLowerCase().includes(searchTerm) ||
            project.description.toLowerCase().includes(searchTerm) ||
            project.communityPartners.some(partner => partner.toLowerCase().includes(searchTerm)) ||
            project.studentConsultingTeam.some(student => student.toLowerCase().includes(searchTerm));

        return hasMatchingSDGTags && hasMatchingTechTags && hasMatchingSearch;
    });
}

function filterProjects() {
    const filteredProjects = [];
    const selectedSDGs = getSelectedCheckboxes('sdg-filter');
    displaySelectedSDGTags(selectedSDGs);
    const selectedTech = getSelectedCheckboxes('tech-filter');
    displaySelectedTechTags(selectedTech);
    const searchTerm = document.getElementById('search').value.toLowerCase();

    for (projects of allProjects) {
        console.log(getMatchingProjects(projects, selectedSDGs, selectedTech, searchTerm))
        filteredProjects.push(getMatchingProjects(projects, selectedSDGs, selectedTech, searchTerm));
    }
    console.log(filteredProjects)

    displayProjects(filteredProjects);
}

document.addEventListener('click', function (event) {
    const sdgDropdown = document.getElementById('sdgGoalsButton');
    sdgDropdown.classList.add('bg-light', 'text-dark');
    const techDropdown = document.getElementById('techImplementedButton');
    techDropdown.classList.add('bg-light', 'text-dark');

    if (!sdgDropdown.contains(event.target) && !techDropdown.contains(event.target)) {
        filterProjects();
    }
});

document.getElementById('search').addEventListener('input', filterProjects);

displayProjects(allProjects);